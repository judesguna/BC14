OBJECT Table 71056 Student Attendance Header
{
  OBJECT-PROPERTIES
  {
    Date=21-01-18;
    Time=12:00:00;
    Modified=Yes;
    Version List=EDU3.0,SJ6.01;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               // Start 01.KATHIR
               AcademicsSetup.GET;
               IF "No.Series" = '' THEN BEGIN
                 AcademicsSetup.TESTFIELD("Attendance No.");
                 NoSeriesMgt.InitSeries(AcademicsSetup."Attendance No.",xRec."No.Series",0D,"No.","No.Series");
               END;
               "Academic Year" := EduVertical.GetAcademicYear;
               // Stop 01.KATHIR
               // Start 07. VANDHANA
               "User ID" := USERID;
               // Stop 07. VANDHANA
             END;

    CaptionML=ENU=Student Attendance Header;
    LookupPageID=Page71066;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                // Start 02.KATHIR
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  AcademicsSetup.GET;
                                                                  NoSeriesMgt.TestManual(AcademicsSetup."Attendance No.");
                                                                  "No.Series" := '';
                                                                END;
                                                                // Stop 02.KATHIR
                                                              END;

                                                   CaptionML=ENU=No. }
    { 2   ;   ;Class               ;Code20        ;CaptionML=ENU=Class }
    { 3   ;   ;Section             ;Code20        ;CaptionML=ENU=Section }
    { 4   ;   ;Date                ;Date          ;CaptionML=ENU=Date }
    { 5   ;   ;Hour                ;Integer       ;OnValidate=BEGIN

                                                                // Start 06.KATHIR
                                                                StudentAttendanceHeader.RESET;
                                                                StudentAttendanceHeader.SETCURRENTKEY(Class,Section,Curriculum,"Academic Year","Subject Code",Date,Hour);
                                                                StudentAttendanceHeader.SETRANGE(Class,Class);
                                                                StudentAttendanceHeader.SETRANGE(Section,Section);
                                                                StudentAttendanceHeader.SETRANGE(Curriculum,Curriculum);
                                                                StudentAttendanceHeader.SETRANGE("Academic Year","Academic Year");
                                                                StudentAttendanceHeader.SETRANGE(Date,Date);
                                                                StudentAttendanceHeader.SETRANGE(Hour,Hour);
                                                                IF StudentAttendanceHeader.FINDFIRST THEN
                                                                  ERROR(Text002);
                                                                // Start 06.KATHIR
                                                              END;

                                                   CaptionML=ENU=Hour;
                                                   BlankZero=Yes }
    { 6   ;   ;Staff Code          ;Code20        ;TableRelation=Employee;
                                                   OnValidate=BEGIN
                                                                // Start 05.KATHIR
                                                                IF Employee.GET("Staff Code") THEN
                                                                  "Staff Name" := Employee."First Name"
                                                                ELSE
                                                                  "Staff Name" := '';
                                                                // Stop 05.KATHIR
                                                              END;

                                                   CaptionML=ENU=Staff Code }
    { 7   ;   ;Present All         ;Boolean       ;CaptionML=ENU=Present All }
    { 8   ;   ;Academic Year       ;Code10        ;CaptionML=ENU=Academic Year;
                                                   Editable=No }
    { 9   ;   ;Curriculum          ;Code20        ;CaptionML=ENU=Curriculum }
    { 10  ;   ;No.Series           ;Code20        ;CaptionML=ENU=No.Series }
    { 11  ;   ;Subject Code        ;Code20        ;TableRelation=Subject;
                                                   OnLookup=BEGIN
                                                              // Start 03.KATHIR
                                                              ClassSubjects.RESET;
                                                              ClassSubjects.SETRANGE(Class,Class);
                                                              ClassSubjects.SETRANGE(Curriculum,Curriculum);
                                                              ClassSubjects.SETRANGE("Academic Year","Academic Year");
                                                              IF PAGE.RUNMODAL(0,ClassSubjects) = ACTION::LookupOK THEN
                                                                "Subject Code" := ClassSubjects.Subject
                                                              // Stop 03.KATHIR
                                                            END;

                                                   CaptionML=ENU=Subject Code }
    { 13  ;   ;Staff Name          ;Text50        ;CaptionML=ENU=Staff Name;
                                                   Editable=No }
    { 14  ;   ;Class Code          ;Code20        ;TableRelation="Class Section";
                                                   OnValidate=BEGIN
                                                                IF ClassSection.GET("Class Code") THEN BEGIN
                                                                  Class := ClassSection.Class;
                                                                  Section := ClassSection.Section;
                                                                  Curriculum := ClassSection.Curriculum;
                                                                  "Academic Year" := ClassSection."Academic Year";
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Class Code }
    { 20  ;   ;FN/AN               ;Option        ;OnValidate=BEGIN
                                                                {
                                                                IF "FN/AN" = 0 THEN
                                                                  ERROR(Text001);

                                                                // Start 10.KATHIR
                                                                StudentAttendanceHeader.RESET;
                                                                StudentAttendanceHeader.SETCURRENTKEY(Class,Section,Curriculum,"Academic Year",Date,"FN/AN");
                                                                StudentAttendanceHeader.SETRANGE(Class,Class);
                                                                StudentAttendanceHeader.SETRANGE(Section,Section);
                                                                StudentAttendanceHeader.SETRANGE(Curriculum,Curriculum);
                                                                StudentAttendanceHeader.SETRANGE("Academic Year","Academic Year");
                                                                StudentAttendanceHeader.SETRANGE(Date,Date);
                                                                StudentAttendanceHeader.SETRANGE("FN/AN","FN/AN");
                                                                IF StudentAttendanceHeader.FINDFIRST THEN
                                                                  ERROR(Text002);
                                                                // Start 10.KATHIR
                                                                  }
                                                              END;

                                                   OptionCaptionML=ENU=" ,FN,AN";
                                                   OptionString=[ ,FN,AN] }
    { 70120;  ;User ID             ;Code20        ;CaptionML=ENU=User ID }
    { 70121;  ;Portal ID           ;Code20        ;CaptionML=ENU=Portal ID }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Class,Section,Curriculum,Academic Year,Subject Code,Date,Hour }
    {    ;Class Code,Subject Code,Date,Hour        }
    {    ;Class,Section,Curriculum,Academic Year,Date,FN/AN }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      AcademicsSetup@1102155000 : Record 71040;
      NoSeriesMgt@1102155001 : Codeunit 396;
      EduVertical@1102155002 : Codeunit 71880;
      StudentAttendanceHeader@1102155003 : Record 71056;
      ClassSubjects@1102155004 : Record 71048;
      Employee@1102155005 : Record 5200;
      ClassSection@1102155007 : Record 71015;
      Text000@1102155008 : TextConst 'ENU=Attendence is created for this subject and hour.';
      Text001@1102159000 : TextConst 'ENU=FN/AN is Mandatory';
      Text002@1102159001 : TextConst 'ENU=Attendence is already created for this Class';

    PROCEDURE Assistedit@1102155000(OldAttendance@1102155000 : Record 71056) : Boolean;
    BEGIN
      // Start 04.KATHIR
      WITH OldAttendance DO BEGIN
        OldAttendance := Rec;
        AcademicsSetup.GET;
        AcademicsSetup.TESTFIELD("Attendance No.");
        IF NoSeriesMgt.SelectSeries(AcademicsSetup."Attendance No.",OldAttendance."No.Series","No.Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          Rec := OldAttendance;
          EXIT(TRUE);
        END;
      END;
      // Stop 04.KATHIR
    END;

    BEGIN
    {
        No   Date      Sign     Trigger                     Description
      -----------------------------------------------------------------------------------------------
        01  05/10/09   KATHIR   OnInsert()                  Code added to generate Number Series and Insert Current Academic year
        02  05/10/09   KATHIR   No. - OnValidate()          Code added to generate Number Series
        03  05/10/09   KATHIR   Subject Code - OnValidate() Code added to look up the subjects for that particular,class,section and Year
        04  05/10/09   KATHIR   Assistedit()                Code added to generate Number Series
        05  11/10/09   KATHIR   Staff Code - OnValidate()   Code added to get Staff Name
        06  15/10/09   KATHIR   Hour - OnValidate()         Code added to check duplication entries
        07  19/10/09   VANDHANA OnInsert                    Code to assign User ID.
        08  23/11/09   VIGNESH  Class - OnValidate()        Code added to get the Class Section & Curriculum
        09  23/11/09   VIGNESH  Class - OnLookup()          Code added to get the Class Section & Curriculum
        10  23/11/09   VIGNESH  Curriculum - OnValidate()   Code added to get the Class Section & Curriculum
        11  23/11/09   VIGNESH  Curriculum - OnLookup()     Code added to get the Class Section & Curriculum
        12  23/11/09   VIGNESH  Section - OnValidate()      Code added to get the Class Section & Curriculum
        13  23/11/09   VIGNESH  Section - OnLookup()        Code added to get the Class Section & Curriculum
        14  25/11/09   VIGNESH  Subject Code - OnLookup()   Code commente for the section filter

      SJ6.01 21/01/18 GB
        Enabled Edit property for class, section and curriculum
    }
    END.
  }
}

