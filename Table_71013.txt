OBJECT Table 71013 Selection process
{
  OBJECT-PROPERTIES
  {
    Date=27-04-18;
    Time=13:44:00;
    Modified=Yes;
    Version List=EDU3.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               // Start 01 VANDHANA
               ADMSetup.GET;
               IF "No Series" = '' THEN BEGIN
                 ADMSetup.TESTFIELD("Selection No.");
                 NoseriesMgt.InitSeries(ADMSetup."Selection No.", xRec."No Series",0D,"Selection No.","No Series");
               END;
               //Stop 01 VANDHANA

               // Start 04 VANDHANA
               "Academic Year" := EduVertical.GetAdmissionYear;
               // Stop 04 VANDHANA

               // Start 05. VANDHANA
               "User ID" := USERID;
               // Stop 05. VANDHANA
             END;

    CaptionML=ENU=Selection process;
    LookupPageID=Page71024;
  }
  FIELDS
  {
    { 1   ;   ;Class               ;Code10        ;TableRelation="Class Card".Class;
                                                   OnValidate=BEGIN
                                                                // Start 07.VIGNESH
                                                                ClassCardLook.ValidateClass(Class,Curriculum,"Academic Year");
                                                                getSeatVacant;
                                                                // Stop 07.VIGNESH
                                                              END;

                                                   OnLookup=BEGIN
                                                              // Start 08.VIGNESH
                                                              ClassCardLook.LookUpClass(Class,Curriculum,"Academic Year");
                                                              getSeatVacant;
                                                              // Stop 08.VIGNESH
                                                            END;

                                                   CaptionML=ENU=Class }
    { 2   ;   ;Curriculum          ;Code10        ;TableRelation="Class Card".Curriculum;
                                                   OnValidate=BEGIN
                                                                // Start 09.VIGNESH
                                                                ClassCardLook.ValidateCurriculum(Class,Curriculum,"Academic Year");
                                                                getSeatVacant;
                                                                // Stop 09.VIGNESH
                                                              END;

                                                   OnLookup=BEGIN
                                                              // Start 10.VIGNESH
                                                              ClassCardLook.LookUpCurriculum(Class,Curriculum,"Academic Year");
                                                              getSeatVacant;
                                                              // Stop 10.VIGNESH
                                                            END;

                                                   CaptionML=ENU=Curriculum }
    { 3   ;   ;Academic Year       ;Code10        ;TableRelation="Academic Year";
                                                   CaptionML=ENU=Academic Year }
    { 4   ;   ;Seats Vacant        ;Integer       ;CaptionML=ENU=Seats Vacant;
                                                   Editable=No }
    { 5   ;   ;Selection No.       ;Code10        ;OnValidate=BEGIN
                                                                // Start 02 VANDHANA
                                                                IF "Selection No." <> xRec."Selection No." THEN BEGIN
                                                                  ADMSetup.GET;
                                                                  NoseriesMgt.TestManual(ADMSetup."Selection No.");
                                                                  "No Series" := '';
                                                                END;
                                                                // Stop 02 VANDHANA
                                                              END;

                                                   CaptionML=ENU=Selection No. }
    { 6   ;   ;No Series           ;Code20        ;CaptionML=ENU=No Series }
    { 7   ;   ;Interview Date      ;Date          ;CaptionML=ENU=Interview Date }
    { 8   ;   ;Total Selected      ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Application WHERE (Application Status=CONST(Selected),
                                                                                        Class=FIELD(Class),
                                                                                        Curriculum Intrested=FIELD(Curriculum),
                                                                                        Academic Year=FIELD(Academic Year)));
                                                   CaptionML=ENU=Total Selected;
                                                   Editable=No }
    { 70120;  ;User ID             ;Code20        ;CaptionML=ENU=User ID }
    { 70121;  ;Portal ID           ;Code20        ;CaptionML=ENU=Portal ID }
  }
  KEYS
  {
    {    ;Selection No.                            }
    {    ;Class                                   ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ADMSetup@1102155000 : Record 71000;
      NoseriesMgt@1102155001 : Codeunit 396;
      SelectionProcess@1102155002 : Record 71013;
      EduVertical@1102155003 : Codeunit 71880;
      ClassCard@1102155004 : Record 71006;
      ClassCardLook@1102155005 : Record 71006;

    PROCEDURE Assistedit@1102155000(Oldsel@1102155000 : Record 71013) : Boolean;
    BEGIN
      // Start 03 VANDHANA
      WITH Oldsel DO BEGIN
        Oldsel := Rec;
        ADMSetup.GET;
        ADMSetup.TESTFIELD("Selection No.");
        IF NoseriesMgt.SelectSeries (ADMSetup."Selection No.", Oldsel."No Series","No Series") THEN BEGIN
          NoseriesMgt.SetSeries("Selection No.");
          Rec := Oldsel;
          EXIT(TRUE);
        END;
      END;
      // Stop 03 VANDHANA
    END;

    PROCEDURE getSeatVacant@1102155005();
    VAR
      ClassCard1@1102155000 : Record 71006;
      Student@1102155001 : Record 71046;
    BEGIN
      // Start 11.VIGNESH
      ClassCard1.GET(Class,Curriculum);
      ClassCard1.CALCFIELDS(Capacity);
      ClassCard1.CALCFIELDS("Present Strength");
      "Seats Vacant" := ClassCard1.Capacity-ClassCard1."Present Strength";
      // Stop 11.VIGNESH
    END;

    BEGIN
    {
         No     Date    Sign     Trigger                 Description
      -----------------------------------------------------------------------------------------------
        01     07/10/09 VANDHANA OnInsert()            Code added for No.series
        02     07/10/09 VANDHANA OnValidate()          Code added for No.series
        03     07/10/09 VANDHANA Assistedit()          Code added for No.series
        04     07/10/09 VANDHANA OnInsert()            Code to insert the Academic Year.
        05     19/10/09 VANDHANA OnInser()             Code to insert the User ID.
        06     16/11/09 GUNA                           New field added interview DATE
        07     23/11/09 VIGNESH  Class - OnValidate()            Code added to get the Class & Curriculum value
        08     23/11/09 VIGNESH  Class - OnLookup()              Code added to get the Class & Curriculum value
        09     23/11/09 VIGNESH  Curriculum - OnValidate()       Code added to get the Class & Curriculum value
        10     23/11/09 VIGNESH  Curriculum - OnLookup()         Code added to get the Class & Curriculum value
        11     24/11/09 VIGNESH  getSeatVacant                    Code added to get the seat vacant
    }
    END.
  }
}

