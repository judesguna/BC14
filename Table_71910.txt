OBJECT Table 71910 Task
{
  OBJECT-PROPERTIES
  {
    Date=30-07-14;
    Time=11:25:27;
    Modified=Yes;
    Version List=EDU2.0;
  }
  PROPERTIES
  {
    OnInsert=BEGIN


               "User ID":= USERID;
               Date:= TODAY;


               // Start 01. Ankesh
               IF "Task No."='' THEN BEGIN
                 TaskSetup.GET;
                 TaskSetup.TESTFIELD(TaskSetup."Task No.");
                 NoSeriesMgt.InitSeries(TaskSetup."Task No.",xRec."No. Series",0D,"Task No.","No. Series");
               END
               // Stop 01. Ankesh
             END;

    CaptionML=ENU=Task;
    LookupPageID=Page71916;
  }
  FIELDS
  {
    { 1   ;   ;Task No.            ;Code20        ;OnValidate=BEGIN
                                                                // Start 02. Ankesh
                                                                IF "Task No." <> xRec."Task No."  THEN BEGIN
                                                                  TaskSetup.GET;
                                                                  NoSeriesMgt.TestManual(TaskSetup."Task No.");
                                                                  "No. Series":='';
                                                                END;
                                                                // Stop 02. Ankesh
                                                              END;

                                                   CaptionML=ENU=Task No. }
    { 2   ;   ;Type                ;Option        ;CaptionML=ENU=Type;
                                                   OptionCaptionML=ENU=" ,Staff,Student";
                                                   OptionString=[ ,Staff,Student] }
    { 3   ;   ;No.                 ;Code20        ;TableRelation=IF (Type=CONST(Staff)) Employee
                                                                 ELSE IF (Type=CONST(Student)) Table33009767;
                                                   CaptionML=ENU=No. }
    { 9   ;   ;Date                ;Date          ;CaptionML=ENU=Starting Date;
                                                   NotBlank=Yes }
    { 10  ;   ;Task Status         ;Option        ;OnValidate=BEGIN
                                                                IF "Task Status" = "Task Status"::Completed THEN
                                                                  VALIDATE(Closed,TRUE)
                                                                ELSE
                                                                  VALIDATE(Closed,FALSE);
                                                              END;

                                                   CaptionML=ENU=Status;
                                                   OptionCaptionML=ENU=Not Started,In Progress,Completed,Waiting,Postponed;
                                                   OptionString=Not Started,In Progress,Completed,Waiting,Postponed }
    { 11  ;   ;Priority            ;Option        ;InitValue=Normal;
                                                   CaptionML=ENU=Priority;
                                                   OptionCaptionML=ENU=Low,Normal,High;
                                                   OptionString=Low,Normal,High }
    { 12  ;   ;Description         ;Text50        ;CaptionML=ENU=Description }
    { 13  ;   ;Closed              ;Boolean       ;OnValidate=BEGIN
                                                                IF Closed THEN BEGIN
                                                                  "Date Closed" := TODAY;
                                                                  "Task Status" := "Task Status"::Completed;
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Closed }
    { 14  ;   ;Date Closed         ;Date          ;CaptionML=ENU=Date Closed;
                                                   Editable=No }
    { 15  ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=ENU=No. Series;
                                                   Editable=No }
    { 17  ;   ;Canceled            ;Boolean       ;OnValidate=BEGIN
                                                                IF Canceled AND NOT Closed THEN
                                                                  VALIDATE(Closed,TRUE);
                                                                IF (NOT Canceled) AND Closed THEN
                                                                  VALIDATE(Closed,FALSE);
                                                              END;

                                                   CaptionML=ENU=Canceled }
    { 19  ;   ;Assinged To         ;Code20        ;CaptionML=ENU=Assinged To }
    { 20  ;   ;Start Date          ;Date          ;CaptionML=ENU=Start Date }
    { 21  ;   ;End Date            ;Date          ;CaptionML=ENU=End Date }
    { 70120;  ;User ID             ;Code20        ;CaptionML=ENU=User ID }
    { 70121;  ;Portal ID           ;Code20        ;CaptionML=ENU=Portal ID }
  }
  KEYS
  {
    {    ;Task No.                                ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text006@1102155000 : TextConst 'ENU=The valid range of dates is from %1 to %2. Please enter a date within this range.';
      Task@1102155003 : Record 71910;
      TaskSetup@1102155002 : Record 71884;
      NoSeriesMgt@1102155001 : Codeunit 396;

    PROCEDURE AssistEdit@1102155000(OldTaskno@1102155000 : Record 71910) : Boolean;
    BEGIN
      // Start 03. Ankesh
      WITH  Task DO BEGIN
        Task := Rec;
        TaskSetup.GET;
        TaskSetup.TESTFIELD(TaskSetup."Task No.");
        IF NoSeriesMgt.SelectSeries(TaskSetup."Task No.",OldTaskno."No. Series","No. Series") THEN BEGIN
          TaskSetup.GET;
          TaskSetup.TESTFIELD(TaskSetup."Task No.");
          NoSeriesMgt.SetSeries("Task No.");
          Rec := Task;
          EXIT(TRUE);
        END;
      END;
      // Stop 03. Ankesh
    END;

    BEGIN
    {
         No    Date        Sign         Trigger              Description
      -----------------------------------------------------------------------------------------------
        01     07.01.10    ANKESH      OnInsert()            To Initialize The Series.
        02     07.01.10    ANKESH    Task No.-OnValidate()   To Run TestManual Function Of NoSeriesManagment Codeunit.
        03     07.01.10    ANKESH      AssistEdit()          The Code will Run when the AssistEdit Button Is activated on Form.
    }
    END.
  }
}

